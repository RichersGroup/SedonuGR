(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     33182,        852]
NotebookOptionsPosition[     32501,        826]
NotebookOutlinePosition[     32839,        841]
CellTagsIndexPosition[     32796,        838]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "x", ",", "y", ",", "z", ",", "x1", ",", "y1", ",", "z1", ",", "x2", ",", 
   "y2", ",", "z2"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x1", "=", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", "-", 
      RowBox[{"z1", " ", "z1"}]}], "]"}], 
    RowBox[{"Cos", "[", "\[Phi]1", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y1", "=", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", "-", 
      RowBox[{"z1", " ", "z1"}]}], "]"}], 
    RowBox[{"Sin", "[", "\[Phi]1", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x2", "=", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", "-", 
      RowBox[{"z2", " ", "z2"}]}], "]"}], 
    RowBox[{"Cos", "[", "\[Phi]2", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y2", "=", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", "-", 
      RowBox[{"z2", " ", "z2"}]}], "]"}], 
    RowBox[{"Sin", "[", "\[Phi]2", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ctheta", " ", "=", " ", 
   RowBox[{
    RowBox[{"x1", " ", "x2"}], "+", 
    RowBox[{"y1", " ", "y2"}], "+", 
    RowBox[{"z1", " ", "z2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f1", "=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"4", " ", "Pi"}], ")"}]}], " ", 
    RowBox[{"(", 
     RowBox[{"e1", "+", 
      RowBox[{"3", " ", "z1", " ", "Fz1"}], "+", 
      RowBox[{"3", " ", "x1", " ", "Fx1"}], "+", 
      RowBox[{"3", " ", "y1", " ", "Fy1"}], "+", 
      RowBox[{
       RowBox[{"15", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Pxx1", " ", 
          RowBox[{"x1", "^", "2"}]}], "+", 
         RowBox[{"Pyy1", " ", 
          RowBox[{"y1", "^", "2"}]}], "+", 
         RowBox[{"Pzz1", " ", 
          RowBox[{"z1", "^", "2"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Pxy1", " ", "x1", " ", "y1"}], "+", 
            RowBox[{"Pxz1", " ", "x1", " ", "z1"}], "+", 
            RowBox[{"Pyz1", " ", "y1", " ", "z1"}]}], ")"}]}], "-", 
         RowBox[{"e1", "/", "3"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"35", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Lxxx1", " ", 
          RowBox[{"x1", "^", "3"}]}], "+", 
         RowBox[{"Lyyy1", " ", 
          RowBox[{"y1", "^", "3"}]}], "+", 
         RowBox[{"Lzzz1", " ", 
          RowBox[{"z1", "^", "3"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"x1", "^", "2"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Lzxx1", " ", "z1"}], "+", 
               RowBox[{"Lyxx1", " ", "y1"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"y1", "^", "2"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Lxyy1", " ", "x1"}], "+", 
               RowBox[{"Lzyy1", " ", "z1"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"z1", "^", "2"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Lxzz1", " ", "x1"}], "+", 
               RowBox[{"Lyzz1", " ", "y1"}]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"6", " ", "x1", " ", "y1", " ", "z1", " ", "Lxyz1"}], "-", 
         RowBox[{
          RowBox[{"3", "/", "5"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Fx1", " ", "x1"}], "+", 
            RowBox[{"Fy1", " ", "y1"}], "+", 
            RowBox[{"Fz1", " ", "z1"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f2", "=", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"4", " ", "Pi"}], ")"}]}], " ", 
     RowBox[{"(", 
      RowBox[{"e2", "+", 
       RowBox[{"3", " ", "z2", " ", "Fz2"}], "+", 
       RowBox[{"3", " ", "x2", " ", "Fx2"}], "+", 
       RowBox[{"3", " ", "y2", " ", "Fy2"}], "+", 
       RowBox[{
        RowBox[{"15", "/", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Pxx2", " ", 
           RowBox[{"x2", "^", "2"}]}], "+", 
          RowBox[{"Pyy2", " ", 
           RowBox[{"y2", "^", "2"}]}], "+", 
          RowBox[{"Pzz2", " ", 
           RowBox[{"z2", "^", "2"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Pxy2", " ", "x2", " ", "y2"}], " ", "+", 
             RowBox[{"Pxz2", " ", "x2", " ", "z2"}], "+", 
             RowBox[{"Pyz2", " ", "y2", " ", "z2"}]}], ")"}]}], "-", 
          RowBox[{"e2", "/", "3"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"35", "/", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Lxxx2", " ", 
           RowBox[{"x2", "^", "3"}]}], "+", 
          RowBox[{"Lyyy2", " ", 
           RowBox[{"y2", "^", "3"}]}], "+", 
          RowBox[{"Lzzz2", " ", 
           RowBox[{"z2", "^", "3"}]}], "+", 
          RowBox[{"3", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"x2", "^", "2"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Lzxx2", " ", "z2"}], "+", 
                RowBox[{"Lyxx2", " ", "y2"}]}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"y2", "^", "2"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Lxyy2", " ", "x2"}], "+", 
                RowBox[{"Lzyy2", " ", "z2"}]}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"z2", "^", "2"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Lxzz2", " ", "x2"}], "+", 
                RowBox[{"Lyzz2", " ", "y2"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"6", " ", "x2", " ", "y2", " ", "z2", " ", "Lxyz2"}], "-", 
          RowBox[{
           RowBox[{"3", "/", "5"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Fx2", " ", "x2"}], "+", 
             RowBox[{"Fy2", " ", "y2"}], "+", 
             RowBox[{"Fz2", " ", "z2"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"kernel", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", "Phi0", " ", 
       RowBox[{"LegendreP", "[", 
        RowBox[{"0", ",", "ctheta"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"3", "/", "2"}], " ", "Phi1", " ", 
       RowBox[{"LegendreP", "[", 
        RowBox[{"1", ",", "ctheta"}], "]"}]}], " ", "+", " ", 
      RowBox[{
       RowBox[{"5", "/", "2"}], " ", "Phi2", " ", 
       RowBox[{"LegendreP", "[", 
        RowBox[{"2", ",", "ctheta"}], "]"}]}]}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kernel", " ", "=", " ", 
   RowBox[{
    RowBox[{"5", "/", "2"}], " ", "Phi2", " ", 
    RowBox[{"LegendreP", "[", 
     RowBox[{"2", ",", "ctheta"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"integrand", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"f1", " ", "f2", " ", "kernel"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"integrandList", "=", 
   RowBox[{"Level", "[", 
    RowBox[{
     RowBox[{"Expand", "[", 
      RowBox[{"Simplify", "[", "integrand", "]"}], "]"}], ",", "1"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Total", "[", 
   RowBox[{"ParallelCombine", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"k1", "+", "k2"}], ")"}], "#"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"z1", ",", 
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Phi]1", ",", "0", ",", 
          RowBox[{"2", "Pi"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"z2", ",", 
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Phi]2", ",", "0", ",", 
          RowBox[{"2", "Pi"}]}], "}"}]}], "]"}], "&"}], ",", 
     "integrandList"}], "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"%", "/.", 
          RowBox[{"Pzz1", "\[Rule]", 
           RowBox[{"e1", "-", "Pxx1", "-", "Pyy1"}]}]}], "/.", 
         RowBox[{"Pzz2", "\[Rule]", 
          RowBox[{"e2", "-", "Pxx2", "-", "Pyy2"}]}]}], "/.", 
        RowBox[{"Lxzz1", "\[Rule]", 
         RowBox[{"Fx1", "-", "Lxxx1", "-", "Lxyy1"}]}]}], "/.", 
       RowBox[{"Lxzz2", "\[Rule]", 
        RowBox[{"Fx2", "-", "Lxxx2", "-", "Lxyy2"}]}]}], "/.", 
      RowBox[{"Lyzz1", "\[Rule]", 
       RowBox[{"Fy1", "-", "Lyxx1", "-", "Lyyy1"}]}]}], "/.", 
     RowBox[{"Lyzz2", "\[Rule]", 
      RowBox[{"Fy2", "-", "Lyxx2", "-", "Lyyy2"}]}]}], "/.", 
    RowBox[{"Lzzz1", "\[Rule]", 
     RowBox[{"Fz1", "-", "Lzxx1", "-", "Lzyy1"}]}]}], "/.", 
   RowBox[{"Lzzz2", "\[Rule]", 
    RowBox[{"Fz2", "-", "Lzxx2", "-", "Lzyy2"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Total", "[", 
   RowBox[{"ParallelCombine", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"k1", " ", "x1"}], "+"}], "*)"}], 
          RowBox[{"k2", " ", "x2"}], ")"}], "#"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"z1", ",", 
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Phi]1", ",", "0", ",", 
          RowBox[{"2", "Pi"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"z2", ",", 
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Phi]2", ",", "0", ",", 
          RowBox[{"2", "Pi"}]}], "}"}]}], "]"}], "&"}], ",", 
     "integrandList"}], "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"%", "/.", 
          RowBox[{"Pzz1", "\[Rule]", 
           RowBox[{"e1", "-", "Pxx1", "-", "Pyy1"}]}]}], "/.", 
         RowBox[{"Pzz2", "\[Rule]", 
          RowBox[{"e2", "-", "Pxx2", "-", "Pyy2"}]}]}], "/.", 
        RowBox[{"Lxzz1", "\[Rule]", 
         RowBox[{"Fx1", "-", "Lxxx1", "-", "Lxyy1"}]}]}], "/.", 
       RowBox[{"Lxzz2", "\[Rule]", 
        RowBox[{"Fx2", "-", "Lxxx2", "-", "Lxyy2"}]}]}], "/.", 
      RowBox[{"Lyzz1", "\[Rule]", 
       RowBox[{"Fy1", "-", "Lyxx1", "-", "Lyyy1"}]}]}], "/.", 
     RowBox[{"Lyzz2", "\[Rule]", 
      RowBox[{"Fy2", "-", "Lyxx2", "-", "Lyyy2"}]}]}], "/.", 
    RowBox[{"Lzzz1", "\[Rule]", 
     RowBox[{"Fz1", "-", "Lzxx1", "-", "Lzyy1"}]}]}], "/.", 
   RowBox[{"Lzzz2", "\[Rule]", 
    RowBox[{"Fz2", "-", "Lzxx2", "-", "Lzyy2"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.726268703830633*^9, 3.726268726582313*^9}, {
   3.726268847611258*^9, 3.726268871541691*^9}, {3.726268902358589*^9, 
   3.726268928958374*^9}, {3.726269048075716*^9, 3.726269071445282*^9}, {
   3.726269103230301*^9, 3.726269105245414*^9}, {3.7262692287960777`*^9, 
   3.726269250885404*^9}, {3.726269411891974*^9, 3.726269416247336*^9}, {
   3.7262695226784077`*^9, 3.726269525373946*^9}, {3.726269589213859*^9, 
   3.7262696011083803`*^9}, {3.7262696524081573`*^9, 
   3.7262696553467913`*^9}, {3.726269909972289*^9, 3.726269932107998*^9}, 
   3.726270173127116*^9, 3.727549134632313*^9, {3.727614312551753*^9, 
   3.727614312728249*^9}, {3.727614346246291*^9, 3.727614349583015*^9}, {
   3.727614506287675*^9, 3.727614532161137*^9}, 3.72761456272512*^9, 
   3.727614769171411*^9, {3.727616003671112*^9, 3.7276160852211533`*^9}, {
   3.72761623121522*^9, 3.727616234802062*^9}, {3.7276162931477127`*^9, 
   3.727616361958218*^9}, 3.727616561698248*^9, 3.72761795880332*^9, 
   3.727618140434043*^9, {3.727636973879384*^9, 3.7276369984279222`*^9}, {
   3.727637065258668*^9, 3.727637069143016*^9}, 3.727637173869348*^9, {
   3.729439533335101*^9, 3.7294396023587008`*^9}, {3.729439798998786*^9, 
   3.729439843564499*^9}, {3.7294407851857977`*^9, 3.729440841297022*^9}, {
   3.729440902462448*^9, 3.729440918673748*^9}, {3.729440991581154*^9, 
   3.729441109297044*^9}, {3.7294415293809443`*^9, 3.729441568774914*^9}, {
   3.729441611379672*^9, 3.729441613826729*^9}, {3.72944166539933*^9, 
   3.729441683609487*^9}, {3.7294420677331047`*^9, 3.729442089790658*^9}, {
   3.7294421237189913`*^9, 3.729442146214427*^9}, {3.729444044571144*^9, 
   3.729444114840826*^9}, 3.729444154194757*^9, {3.7294443753482122`*^9, 
   3.729444397426264*^9}, {3.729444577872096*^9, 3.7294445971125526`*^9}, {
   3.729445191458064*^9, 3.729445195715539*^9}, {3.729445758280204*^9, 
   3.729445804361484*^9}, {3.7294460780481167`*^9, 3.7294460886067133`*^9}, {
   3.729446737810589*^9, 3.7294467417262297`*^9}, 3.7294468117975197`*^9, {
   3.729446844395944*^9, 3.72944684997789*^9}, {3.729446900172738*^9, 
   3.72944690868382*^9}, 3.7294469766133842`*^9, {3.729447494832592*^9, 
   3.7294475106878557`*^9}, 3.7294475414577847`*^9, 3.729447586766638*^9, 
   3.7294476850726337`*^9, {3.729447775751093*^9, 3.7294477863219547`*^9}, 
   3.7294484095892067`*^9, 3.7294484624541817`*^9, {3.729448760594802*^9, 
   3.7294487919303493`*^9}, {3.7294488741021347`*^9, 3.729448944259256*^9}, {
   3.7294490042932577`*^9, 3.729449009060603*^9}, 3.7294491794260063`*^9, {
   3.729449436582807*^9, 3.729449494954*^9}, 3.72944978574396*^9, {
   3.72945255381674*^9, 3.7294526144200983`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["5", "4"], " ", 
  RowBox[{"(", 
   RowBox[{"k1", "+", "k2"}], ")"}], " ", "Phi2", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"6", " ", "Pxy1", " ", "Pxy2"}], "+", 
    RowBox[{"6", " ", "Pxz1", " ", "Pxz2"}], "+", 
    RowBox[{"2", " ", "Pyy1", " ", "Pyy2"}], "+", 
    RowBox[{"6", " ", "Pyz1", " ", "Pyz2"}], "-", 
    RowBox[{"Pyy2", " ", "Pzz1"}], "-", 
    RowBox[{"Pxx2", " ", 
     RowBox[{"(", 
      RowBox[{"Pyy1", "+", "Pzz1"}], ")"}]}], "+", 
    RowBox[{"Pxx1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "Pxx2"}], "-", "Pyy2", "-", "Pzz2"}], ")"}]}], "-", 
    RowBox[{"Pyy1", " ", "Pzz2"}], "+", 
    RowBox[{"2", " ", "Pzz1", " ", "Pzz2"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.72626904369499*^9, 3.726269096861745*^9, {3.7262692309685783`*^9, 
   3.7262692614822197`*^9}, 3.7262693619926233`*^9, 3.726269419482057*^9, 
   3.726269526374361*^9, 3.7262695908113823`*^9, 3.7262696899613857`*^9, 
   3.726269945194628*^9, 3.7262703579546633`*^9, 3.727549139341309*^9, 
   3.727614419356841*^9, {3.7276145102987022`*^9, 3.727614533797455*^9}, 
   3.727614565958734*^9, 3.727614852285873*^9, {3.7276160390289507`*^9, 
   3.727616050828877*^9}, 3.727616086390214*^9, 3.727616236624256*^9, 
   3.727616324706182*^9, 3.727616364635866*^9, 3.727616464483889*^9, 
   3.727616657593145*^9, 3.727618008135068*^9, 3.7276188377099047`*^9, 
   3.7276370306309*^9, 3.727637268689198*^9, 3.729439619156201*^9, 
   3.7294399253122587`*^9, 3.729441008657607*^9, 3.7294410551082983`*^9, 
   3.7294415541260033`*^9, 3.729444155988029*^9, 3.7294442534257298`*^9, 
   3.729444497406304*^9, 3.729444699133412*^9, 3.729445221120758*^9, 
   3.729445782924362*^9, 3.729445824802247*^9, 3.729446107531074*^9, 
   3.729446761447785*^9, 3.729446830149926*^9, 3.729446869641602*^9, 
   3.729446927726708*^9, 3.729447052320101*^9, 3.7294475158894033`*^9, 
   3.729447562241788*^9, 3.729447658484812*^9, 3.72944775500285*^9, 
   3.729447858938582*^9, 3.7294484309180517`*^9, 3.729448467974483*^9, 
   3.729448785522065*^9, 3.72944882166601*^9, 3.729448974758061*^9, 
   3.729449154284205*^9, 3.729449331080319*^9, 3.729449655500587*^9, 
   3.7294501815871773`*^9, 3.729453020630941*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["5", "4"], " ", 
  RowBox[{"(", 
   RowBox[{"k1", "+", "k2"}], ")"}], " ", "Phi2", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"e1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "e2"}], "-", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"Pxx2", "+", "Pyy2"}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "Pxx1", " ", "Pxx2"}], "+", 
       RowBox[{"2", " ", "Pxy1", " ", "Pxy2"}], "+", 
       RowBox[{"2", " ", "Pxz1", " ", "Pxz2"}], "+", 
       RowBox[{"Pxx2", " ", "Pyy1"}], "-", 
       RowBox[{"e2", " ", 
        RowBox[{"(", 
         RowBox[{"Pxx1", "+", "Pyy1"}], ")"}]}], "+", 
       RowBox[{"Pxx1", " ", "Pyy2"}], "+", 
       RowBox[{"2", " ", "Pyy1", " ", "Pyy2"}], "+", 
       RowBox[{"2", " ", "Pyz1", " ", "Pyz2"}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.72626904369499*^9, 3.726269096861745*^9, {3.7262692309685783`*^9, 
   3.7262692614822197`*^9}, 3.7262693619926233`*^9, 3.726269419482057*^9, 
   3.726269526374361*^9, 3.7262695908113823`*^9, 3.7262696899613857`*^9, 
   3.726269945194628*^9, 3.7262703579546633`*^9, 3.727549139341309*^9, 
   3.727614419356841*^9, {3.7276145102987022`*^9, 3.727614533797455*^9}, 
   3.727614565958734*^9, 3.727614852285873*^9, {3.7276160390289507`*^9, 
   3.727616050828877*^9}, 3.727616086390214*^9, 3.727616236624256*^9, 
   3.727616324706182*^9, 3.727616364635866*^9, 3.727616464483889*^9, 
   3.727616657593145*^9, 3.727618008135068*^9, 3.7276188377099047`*^9, 
   3.7276370306309*^9, 3.727637268689198*^9, 3.729439619156201*^9, 
   3.7294399253122587`*^9, 3.729441008657607*^9, 3.7294410551082983`*^9, 
   3.7294415541260033`*^9, 3.729444155988029*^9, 3.7294442534257298`*^9, 
   3.729444497406304*^9, 3.729444699133412*^9, 3.729445221120758*^9, 
   3.729445782924362*^9, 3.729445824802247*^9, 3.729446107531074*^9, 
   3.729446761447785*^9, 3.729446830149926*^9, 3.729446869641602*^9, 
   3.729446927726708*^9, 3.729447052320101*^9, 3.7294475158894033`*^9, 
   3.729447562241788*^9, 3.729447658484812*^9, 3.72944775500285*^9, 
   3.729447858938582*^9, 3.7294484309180517`*^9, 3.729448467974483*^9, 
   3.729448785522065*^9, 3.72944882166601*^9, 3.729448974758061*^9, 
   3.729449154284205*^9, 3.729449331080319*^9, 3.729449655500587*^9, 
   3.7294501815871773`*^9, 3.729453020849834*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["5", "4"], " ", "k2", " ", "Phi2", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "Fx2", " ", "Pxx1"}], "+", 
    RowBox[{"4", " ", "Lxxx2", " ", "Pxx1"}], "+", 
    RowBox[{"Lxyy2", " ", "Pxx1"}], "+", 
    RowBox[{"Lxzz2", " ", "Pxx1"}], "+", 
    RowBox[{"Fx2", " ", "Pyy1"}], "-", 
    RowBox[{"2", " ", "Lxxx2", " ", "Pyy1"}], "+", 
    RowBox[{"Lxyy2", " ", "Pyy1"}], "-", 
    RowBox[{"2", " ", "Lxzz2", " ", "Pyy1"}], "+", 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "Fy2"}], "+", 
          RowBox[{"3", " ", "Lyxx2"}], "+", "Lyyy2", "+", "Lyzz2"}], ")"}], 
        " ", "Pxy1"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "Fz2"}], "+", 
          RowBox[{"3", " ", "Lzxx2"}], "+", "Lzyy2", "+", "Lzzz2"}], ")"}], 
        " ", "Pxz1"}], "+", 
       RowBox[{"2", " ", "Lxyz2", " ", "Pyz1"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Fx2", "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"Lxxx2", "+", "Lxyy2"}], ")"}]}], "+", "Lxzz2"}], ")"}], " ",
      "Pzz1"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.72626904369499*^9, 3.726269096861745*^9, {3.7262692309685783`*^9, 
   3.7262692614822197`*^9}, 3.7262693619926233`*^9, 3.726269419482057*^9, 
   3.726269526374361*^9, 3.7262695908113823`*^9, 3.7262696899613857`*^9, 
   3.726269945194628*^9, 3.7262703579546633`*^9, 3.727549139341309*^9, 
   3.727614419356841*^9, {3.7276145102987022`*^9, 3.727614533797455*^9}, 
   3.727614565958734*^9, 3.727614852285873*^9, {3.7276160390289507`*^9, 
   3.727616050828877*^9}, 3.727616086390214*^9, 3.727616236624256*^9, 
   3.727616324706182*^9, 3.727616364635866*^9, 3.727616464483889*^9, 
   3.727616657593145*^9, 3.727618008135068*^9, 3.7276188377099047`*^9, 
   3.7276370306309*^9, 3.727637268689198*^9, 3.729439619156201*^9, 
   3.7294399253122587`*^9, 3.729441008657607*^9, 3.7294410551082983`*^9, 
   3.7294415541260033`*^9, 3.729444155988029*^9, 3.7294442534257298`*^9, 
   3.729444497406304*^9, 3.729444699133412*^9, 3.729445221120758*^9, 
   3.729445782924362*^9, 3.729445824802247*^9, 3.729446107531074*^9, 
   3.729446761447785*^9, 3.729446830149926*^9, 3.729446869641602*^9, 
   3.729446927726708*^9, 3.729447052320101*^9, 3.7294475158894033`*^9, 
   3.729447562241788*^9, 3.729447658484812*^9, 3.72944775500285*^9, 
   3.729447858938582*^9, 3.7294484309180517`*^9, 3.729448467974483*^9, 
   3.729448785522065*^9, 3.72944882166601*^9, 3.729448974758061*^9, 
   3.729449154284205*^9, 3.729449331080319*^9, 3.729449655500587*^9, 
   3.7294501815871773`*^9, 3.729453223940405*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["5", "4"], " ", "k2", " ", "Phi2", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"e1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "Fx2"}], "-", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{"Lxxx2", "+", "Lxyy2"}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "Lxxx2", " ", "Pxx1"}], "+", 
       RowBox[{"Lxyy2", " ", "Pxx1"}], "+", 
       RowBox[{"2", " ", "Lyxx2", " ", "Pxy1"}], "+", 
       RowBox[{"2", " ", "Lzxx2", " ", "Pxz1"}], "+", 
       RowBox[{"Lxxx2", " ", "Pyy1"}], "+", 
       RowBox[{"2", " ", "Lxyy2", " ", "Pyy1"}], "-", 
       RowBox[{"Fx2", " ", 
        RowBox[{"(", 
         RowBox[{"Pxx1", "+", "Pyy1"}], ")"}]}], "+", 
       RowBox[{"2", " ", "Lxyz2", " ", "Pyz1"}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.72626904369499*^9, 3.726269096861745*^9, {3.7262692309685783`*^9, 
   3.7262692614822197`*^9}, 3.7262693619926233`*^9, 3.726269419482057*^9, 
   3.726269526374361*^9, 3.7262695908113823`*^9, 3.7262696899613857`*^9, 
   3.726269945194628*^9, 3.7262703579546633`*^9, 3.727549139341309*^9, 
   3.727614419356841*^9, {3.7276145102987022`*^9, 3.727614533797455*^9}, 
   3.727614565958734*^9, 3.727614852285873*^9, {3.7276160390289507`*^9, 
   3.727616050828877*^9}, 3.727616086390214*^9, 3.727616236624256*^9, 
   3.727616324706182*^9, 3.727616364635866*^9, 3.727616464483889*^9, 
   3.727616657593145*^9, 3.727618008135068*^9, 3.7276188377099047`*^9, 
   3.7276370306309*^9, 3.727637268689198*^9, 3.729439619156201*^9, 
   3.7294399253122587`*^9, 3.729441008657607*^9, 3.7294410551082983`*^9, 
   3.7294415541260033`*^9, 3.729444155988029*^9, 3.7294442534257298`*^9, 
   3.729444497406304*^9, 3.729444699133412*^9, 3.729445221120758*^9, 
   3.729445782924362*^9, 3.729445824802247*^9, 3.729446107531074*^9, 
   3.729446761447785*^9, 3.729446830149926*^9, 3.729446869641602*^9, 
   3.729446927726708*^9, 3.729447052320101*^9, 3.7294475158894033`*^9, 
   3.729447562241788*^9, 3.729447658484812*^9, 3.72944775500285*^9, 
   3.729447858938582*^9, 3.7294484309180517`*^9, 3.729448467974483*^9, 
   3.729448785522065*^9, 3.72944882166601*^9, 3.729448974758061*^9, 
   3.729449154284205*^9, 3.729449331080319*^9, 3.729449655500587*^9, 
   3.7294501815871773`*^9, 3.729453224141706*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Different complexities:", "Subsection",
 CellChangeTimes->{{3.726269143495905*^9, 3.726269147031766*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f1", "=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"4", " ", "Pi"}], ")"}]}], " ", 
    RowBox[{"(", "e1", ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2", "=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"4", " ", "Pi"}], ")"}]}], " ", 
    RowBox[{"(", "e2", ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.726269218746353*^9, 3.72626922125819*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f1", "=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"4", " ", "Pi"}], ")"}]}], " ", 
    RowBox[{"(", 
     RowBox[{"e1", "+", 
      RowBox[{"3", " ", "z1", " ", "Fz1"}], "+", 
      RowBox[{"3", " ", "x1", " ", "Fx1"}], "+", 
      RowBox[{"3", " ", "y1", " ", "Fy1"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2", "=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"4", " ", "Pi"}], ")"}]}], " ", 
    RowBox[{"(", 
     RowBox[{"e2", "+", 
      RowBox[{"3", " ", "z2", " ", "Fz2"}], "+", 
      RowBox[{"3", " ", "x2", " ", "Fx2"}], "+", 
      RowBox[{"3", " ", "y2", " ", "Fy2"}]}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7262692049721193`*^9, 3.726269209580036*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f1", "=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"4", " ", "Pi"}], ")"}]}], " ", 
    RowBox[{"(", 
     RowBox[{"e1", "+", 
      RowBox[{"3", " ", "z1", " ", "Fz1"}], "+", 
      RowBox[{"3", " ", "x1", " ", "Fx1"}], "+", 
      RowBox[{"3", " ", "y1", " ", "Fy1"}], "+", 
      RowBox[{
       RowBox[{"15", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Pxx1", " ", 
          RowBox[{"x1", "^", "2"}]}], "+", 
         RowBox[{"Pyy1", " ", 
          RowBox[{"y1", "^", "2"}]}], "+", 
         RowBox[{"Pzz1", " ", 
          RowBox[{"z1", "^", "2"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Pxy1", " ", "x1", " ", "y1"}], "+", 
            RowBox[{"Pxz1", " ", "x1", " ", "z1"}], "+", 
            RowBox[{"Pyz1", " ", "y1", " ", "z1"}]}], ")"}]}], "-", 
         RowBox[{"e1", "/", "3"}]}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2", "=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"4", " ", "Pi"}], ")"}]}], " ", 
    RowBox[{"(", 
     RowBox[{"e2", "+", 
      RowBox[{"3", " ", "z2", " ", "Fz2"}], "+", 
      RowBox[{"3", " ", "x2", " ", "Fx2"}], "+", 
      RowBox[{"3", " ", "y2", " ", "Fy2"}], "+", 
      RowBox[{
       RowBox[{"15", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Pxx2", " ", 
          RowBox[{"x2", "^", "2"}]}], "+", 
         RowBox[{"Pyy2", " ", 
          RowBox[{"y2", "^", "2"}]}], "+", 
         RowBox[{"Pzz2", " ", 
          RowBox[{"z2", "^", "2"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Pxy2", " ", "x2", " ", "y2"}], "+", 
            RowBox[{"Pxz2", " ", "x2", " ", "z2"}], "+", 
            RowBox[{"Pyz2", " ", "y2", " ", "z2"}]}], ")"}]}], "-", 
         RowBox[{"e2", "/", "3"}]}], ")"}]}]}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.726269172655982*^9, 3.7262691956854687`*^9}, {
  3.7262699188100777`*^9, 3.726269925794016*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f1", "=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"4", " ", "Pi"}], ")"}]}], " ", 
    RowBox[{"(", 
     RowBox[{"e1", "+", 
      RowBox[{"3", " ", "z1", " ", "Fz1"}], "+", 
      RowBox[{"3", " ", "x1", " ", "Fx1"}], "+", 
      RowBox[{"3", " ", "y1", " ", "Fy1"}], "+", 
      RowBox[{
       RowBox[{"15", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Pxx1", " ", 
          RowBox[{"x1", "^", "2"}]}], "+", 
         RowBox[{"Pyy1", " ", 
          RowBox[{"y1", "^", "2"}]}], "+", 
         RowBox[{"Pzz1", " ", 
          RowBox[{"z1", "^", "2"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Pxy1", " ", "x1", " ", "y1"}], "+", 
            RowBox[{"Pxz1", " ", "x1", " ", "z1"}], "+", 
            RowBox[{"Pyz1", " ", "y1", " ", "z1"}]}], ")"}]}], "-", 
         RowBox[{"e1", "/", "3"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"35", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Lxxx1", " ", 
          RowBox[{"x1", "^", "3"}]}], "+", 
         RowBox[{"Lyyy1", " ", 
          RowBox[{"y1", "^", "3"}]}], "+", 
         RowBox[{"Lzzz1", " ", 
          RowBox[{"z1", "^", "3"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"x1", "^", "2"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Lzxx1", " ", "z1"}], "+", 
               RowBox[{"Lyxx1", " ", "y1"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"y1", "^", "2"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Lxyy1", " ", "x1"}], "+", 
               RowBox[{"Lzyy1", " ", "z1"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"z1", "^", "2"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Lxzz1", " ", "x1"}], "+", 
               RowBox[{"Lyzz1", " ", "y1"}]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"6", " ", "x1", " ", "y1", " ", "z1", " ", "Lxyz1"}], "-", 
         RowBox[{
          RowBox[{"3", "/", "5"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Fx1", " ", "x1"}], "+", 
            RowBox[{"Fy1", " ", "y1"}], "+", 
            RowBox[{"Fz1", " ", "z1"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2", "=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"4", " ", "Pi"}], ")"}]}], " ", 
    RowBox[{"(", 
     RowBox[{"e2", "+", 
      RowBox[{"3", " ", "z2", " ", "Fz2"}], "+", 
      RowBox[{"3", " ", "x2", " ", "Fx2"}], "+", 
      RowBox[{"3", " ", "y2", " ", "Fy2"}], "+", 
      RowBox[{
       RowBox[{"15", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Pxx2", " ", 
          RowBox[{"x2", "^", "2"}]}], "+", 
         RowBox[{"Pyy2", " ", 
          RowBox[{"y2", "^", "2"}]}], "+", 
         RowBox[{"Pzz2", " ", 
          RowBox[{"z2", "^", "2"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Pxy2", " ", "x2", " ", "y2"}], " ", "+", 
            RowBox[{"Pxz2", " ", "x2", " ", "z2"}], "+", 
            RowBox[{"Pyz2", " ", "y2", " ", "z2"}]}], ")"}]}], "-", 
         RowBox[{"e2", "/", "3"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"35", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Lxxx2", " ", 
          RowBox[{"x2", "^", "3"}]}], "+", 
         RowBox[{"Lyyy2", " ", 
          RowBox[{"y2", "^", "3"}]}], "+", 
         RowBox[{"Lzzz2", " ", 
          RowBox[{"z2", "^", "3"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"x2", "^", "2"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Lzxx2", " ", "z2"}], "+", 
               RowBox[{"Lyxx2", " ", "y2"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"y2", "^", "2"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Lxyy2", " ", "x2"}], "+", 
               RowBox[{"Lzyy2", " ", "z2"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"z2", "^", "2"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Lxzz2", " ", "x2"}], "+", 
               RowBox[{"Lyzz2", " ", "y2"}]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"6", " ", "x2", " ", "y2", " ", "z2", " ", "Lxyz2"}], "-", 
         RowBox[{
          RowBox[{"3", "/", "5"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Fx2", " ", "x2"}], "+", 
            RowBox[{"Fy2", " ", "y2"}], "+", 
            RowBox[{"Fz2", " ", "z2"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.726269191285285*^9, 3.72626919158142*^9}, 
   3.726269851966403*^9}]
}, Open  ]]
},
WindowSize->{1916, 893},
WindowMargins->{{Automatic, -14}, {Automatic, 68}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 13645, 347, 495, "Input"],
Cell[14227, 371, 2242, 42, 49, "Output"],
Cell[16472, 415, 2415, 49, 49, "Output"],
Cell[18890, 466, 2746, 58, 73, "Output"],
Cell[21639, 526, 2378, 47, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24054, 578, 111, 1, 44, "Subsection"],
Cell[24168, 581, 462, 15, 55, "Input"],
Cell[24633, 598, 800, 24, 55, "Input"],
Cell[25436, 624, 2103, 59, 55, "Input"],
Cell[27542, 685, 4943, 138, 143, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
